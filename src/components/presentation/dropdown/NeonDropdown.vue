<template>
  <div
    class="neon-dropdown"
    :class="[
      {
        'neon-dropdown--with-indicator': indicator,
        'neon-dropdown--open': value,
        'neon-dropdown--open-on-hover': openOnHover,
        'neon-dropdown--icon-only': icon && !label,
        'neon-dropdown--disabled': disabled,
      },
      `neon-dropdown--${size}`,
      `neon-dropdown--${color}`,
    ]"
  >
    <!-- @slot optionally replace the dropdown button with a custom control -->
    <slot name="dropdown-button">
      <div
        ref="dropdownButton"
        v-if="dropdownStyle === 'text-button' || dropdownStyle === 'solid-button'"
        class="neon-dropdown__button-wrapper"
      >
        <neon-button
          class="neon-dropdown__button"
          :button-style="dropdownStyle === 'text-button' ? 'text' : 'solid'"
          :color="color"
          :alternate-color="alternateColor"
          :size="size"
          :indicator="indicator"
          :indicator-expanded="value"
          :disabled="disabled"
          :label="label"
          :icon="icon"
          @click="toggleOpen()"
          @blur="onBlur()"
          @focus="onFocus()"
          aria-haspopup="true"
          :aria-expanded="value"
        />
      </div>
      <div
        v-else
        @click="toggleOpen"
        @keydown.enter="toggleOpen"
        @keydown.space="toggleOpen"
        @keypress.space.prevent=""
        ref="dropdownButton"
        role="button"
        :tabindex="!disabled ? 0 : undefined"
        class="neon-dropdown__badge"
      >
        <neon-badge
          :icon="icon"
          :label="label"
          :size="size"
          :color="color"
          :alternate-color="alternateColor"
          :disabled="disabled"
          :circular="dropdownStyle === 'circular-badge'"
          :image="image"
          :imageAlt="imageAlt"
        />
        <neon-expansion-indicator
          v-if="indicator"
          class="neon-button__indicator"
          :disabled="disabled"
          :color="color"
          :expanded="value"
        />
      </div>
    </slot>
    <div class="neon-dropdown__click-blocker" />
    <div
      ref="dropdownContent"
      v-show="openOnHover || value"
      class="neon-dropdown__content"
      :class="`neon-dropdown__content--${dropdownPlacement}`"
    >
      <!-- @slot The content of the open dropdown -->
      <slot></slot>
    </div>
  </div>
</template>

<script lang="ts" src="./NeonDropdown.ts"></script>
