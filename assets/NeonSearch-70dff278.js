import{a as q,d as H,l as R,g as T,_ as G}from"../index.js";import{N as Q,a as h}from"./NeonDropdown-f9c34229.js";import{N as j}from"./NeonChip-3363ca9c.js";import{N as J}from"./NeonScrollUtils-e1749a09.js";import{u as W,v as X,R as c,V as Y,S as Z,U as x,w as A,D as y,x as u,y as g,L as V,G as B,H as v,P as z,M as I,O,F as D,A as L,z as P,I as ee,Q as oe}from"./vendor-7a8d752b.js";const ne=W({name:"NeonSearch",components:{NeonChip:j,NeonDropdown:Q,NeonIcon:q,NeonInput:H},props:{modelValue:{type:[String,Array],required:!0},placeholder:{type:String,required:!0},options:{type:Array,required:!0},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},size:{type:String,default:R.Medium},color:{type:String,default:T.LowContrast},placement:{type:String,default:h.BottomLeft}},emits:["update:modelValue","filter-changed"],setup(e,{emit:l}){const C=X(),b=c(null),f=c(e.placement),i=c(!1),t=c(null),s=c(-1),m=c("");Y(()=>i.value,o=>{o&&e.options.length>0&&(t.value=e.options[0].key,s.value=0)});const k=()=>{switch(f.value){case h.TopLeft:case h.TopRight:case h.LeftBottom:case h.RightBottom:return!0}return!1},n=()=>{var a;const o=(a=b.value)==null?void 0:a.querySelector(".neon-search__option--highlighted");J.scrollIntoView(o)},r=(o,a)=>{const d=s.value+o;d>=0&&d<=e.options.length-1&&(s.value=d,t.value=e.options[s.value].key,a.preventDefault(),setTimeout(n))},p=o=>{l("update:modelValue",o)},N=o=>{e.multiple||p(""),m.value=o,l("filter-changed",o)},S=o=>{if(e.multiple){const a=e.modelValue.map(w=>w),d=a.findIndex(w=>w.key===o.key);d>=0?a.splice(d,1):a.push(o),p(a)}else p(o.key);N(e.multiple?"":o.label.toString())},_=o=>{if(i.value)switch(o.code){case"ArrowUp":case"ArrowDown":{const a=k()?-1:1;o.code==="ArrowUp"?r(-1*a,o):r(1*a,o)}break;case"Enter":case"Space":o.target.classList.contains("neon-search__input")||(S(e.options[s.value]),o.preventDefault());break;case"Tab":!o.ctrlKey&&!o.metaKey&&!o.altKey&&(i.value=!1);break}},F=o=>{f.value=o};Z(()=>{document.addEventListener("keydown",_)}),x(()=>{document.removeEventListener("keydown",_)});const U=A(()=>{const{onFilterChanged:o,...a}=C;return a}),$=o=>{t.value=o,s.value=e.options.findIndex(a=>a.key===o)},E=()=>i.value=!0,K=o=>p(e.modelValue.filter(a=>a.key!==o.key)),M=A(()=>e.multiple?e.options:e.options.filter(o=>o.label!==m.value));return{dropdown:b,open:i,highlightedKey:t,filter:m,sanitizedAttributes:U,computedOptions:M,dropdownPlacement:f,onPlacement:F,onFilterChange:N,clickOption:S,changeHighlighted:$,showOptions:E,removeSelected:K}}}),ae={class:"neon-search__wrapper"},le={class:"no-style neon-search__options"},se=["id","onClick","onMouseover"],te={class:"neon-search__option-container"},ie={class:"neon-search__option-label"};function re(e,l,C,b,f,i){const t=y("neon-icon"),s=y("neon-chip"),m=y("neon-input"),k=y("neon-dropdown");return u(),g("div",ae,[V(k,P({ref:"dropdown",modelValue:e.open,"onUpdate:modelValue":l[2]||(l[2]=n=>e.open=n),"aria-activedescendant":e.multiple&&Array.isArray(e.modelValue)?e.modelValue[0]&&e.modelValue[0].key:e.modelValue,"aria-multiselectable":e.multiple,class:[[`neon-search--${e.color}`,{"neon-search--multiple":e.multiple,"neon-search--disabled":e.disabled,"neon-search--empty":e.computedOptions.length===0}],"neon-search"],color:e.color,disabled:e.disabled,placement:e.dropdownPlacement,size:e.size,role:"listbox"},e.sanitizedAttributes,{onDropdownPlacement:e.onPlacement}),{"dropdown-button":B(()=>[v("div",{ref:"dropdownButton",class:z([[`neon-search__container--${e.size}`,`neon-search__container--${e.color}`,{"neon-search__container--disabled":e.disabled}],"neon-search__container"])},[V(t,{disabled:e.disabled,class:"neon-search__search-icon",color:"low-contrast",name:"search"},null,8,["disabled"]),e.multiple&&Array.isArray(e.modelValue)?(u(!0),g(I,{key:0},O(e.modelValue,(n,r)=>(u(),D(s,{id:n.key,key:n.key,class:z({"neon-chip--last-chip":r===e.modelValue.length-1}),color:n.chipColor,disabled:e.disabled,label:n.label,size:e.size,action:"remove","aria-selected":"true",role:"option",onClose:p=>e.removeSelected(n)},null,8,["id","class","color","disabled","label","size","onClose"]))),128)):L("",!0),V(m,P({disabled:e.disabled,modelValue:e.filter,placeholder:e.placeholder,size:e.size,class:"neon-search__input"},e.sanitizedAttributes,{onFocus:l[0]||(l[0]=n=>e.showOptions()),"onUpdate:modelValue":e.onFilterChange,onIconClick:l[1]||(l[1]=n=>e.onFilterChange(""))}),null,16,["disabled","modelValue","placeholder","size","onUpdate:modelValue"])],2)]),default:B(()=>[v("ul",le,[(u(!0),g(I,null,O(e.computedOptions,n=>(u(),g("li",{id:n.key,key:n.key,class:z([[{"neon-search__option--separator-before":n.separatorBefore,"neon-search__option--highlighted":n.key===e.highlightedKey},`neon-search__option--${e.size}`],"neon-search__option"]),"aria-selected":"false",role:"option",onClick:r=>e.clickOption(n),onMouseover:r=>e.changeHighlighted(n.key)},[v("div",te,[ee(e.$slots,"option",{option:n},()=>[n.icon?(u(),D(t,{key:0,name:n.icon,class:"neon-search__option-icon"},null,8,["name"])):L("",!0),v("span",ie,oe(n.label),1)])])],42,se))),128))])]),_:3},16,["modelValue","aria-activedescendant","aria-multiselectable","class","color","disabled","placement","size","onDropdownPlacement"])])}const he=G(ne,[["render",re]]);export{he as N};
